---
title: "Prediction of stroke"
output: html_document
date: "2022-11-18"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Null hypothesis: 
#There is no relationship between the variables like gender, age, various diseases, and smoking status and stroke, the 2nd leading cause of death.

#According to the World Health Organization (WHO) stroke is the 2nd leading cause of death globally, responsible for approximately 11% of total deaths.
#This dataset is used to predict whether a patient is likely to get stroke based on the input parameters like gender, age, various diseases, and smoking status. Each row in the data provides relavant information about the patient.
#Attribute Information

#1) id: unique identifier
#2) gender: "Male", "Female" or "Other"
#3) age: age of the patient
#4) hypertension: 0 if the patient doesn't have hypertension, 1 if the patient has hypertension
#5) heart_disease: 0 if the patient doesn't have any heart diseases, 1 if the patient has a heart disease
#6) ever_married: "No" or "Yes"
#7) work_type: "children", "Govt_jov", "Never_worked", "Private" or "Self-employed"
#8) Residence_type: "Rural" or "Urban"
#9) avg_glucose_level: average glucose level in blood
#10) bmi: body mass index
#11) smoking_status: "formerly smoked", "never smoked", "smokes" or "Unknown"*
#12) stroke: 1 if the patient had a stroke or 0 if not
#*Note: "Unknown" in smoking_status means that the information is unavailable for this patient

```{r}

getwd()
Stroke_dataset <- read.csv("/Users/nehabhasin/Desktop/HS631-STATS/PREDICTION OF STROKE_PROJECT/prediction_of_stroke-project_1/data/Stroke_dataset.csv",header = TRUE, sep = ",")

head(Stroke_dataset)
str(Stroke_dataset)

any(is.na(Stroke_dataset))
colSums(is.na(Stroke_dataset))

```


```{r}

summary(Stroke_dataset)
Stroke_dataset$bmi[is.na(Stroke_dataset$bmi)] <- 0
Stroke_dataset$bmi[Stroke_dataset$bmi==0] <- sample(23.50:28.89,replace=TRUE)

```

```{r}
###Swarna
# Aim to predict if the patient will have stroke
#Does the patient experience stroke
# Null Hypothesis: Patients will not have stroke
#Alternative hypothesis: Patients will have stroke 
#Methodology: Use Multiple logistic regression to predict
#Dependent variable: Stroke
#Independent variables: 10 independent variables
#outcome variable: Stroke
#Quantitative variables: age, avg glucose level, bmi, stroke, sus BP, diaBP, BMI, on admit heart rate
#Categorical: gender, hypertension, heart disease, ever married, work type, residence type, smoking status

Stroke <- read.csv("Stroke_dataset.csv",header = TRUE, sep = ",")
any(is.na(Stroke))
Stroke[is.na(Stroke)] <- 0
summary(Stroke)
str(Stroke)


Stroke$bmi[Stroke$bmi == 0] <- runif(sum(Stroke$bmi == 0), min = 23, max = 28.8)

Stroke$gender <- as.factor(Stroke$gender)
Stroke$ever_married <- as.factor(Stroke$ever_married)
Stroke$work_type <- as.factor(Stroke$work_type)
Stroke$Residence_type <- as.factor(Stroke$Residence_type)
Stroke$smoking_status <- as.factor(Stroke$smoking_status)

summary(Stroke)

Stroke$hypertension <- as.factor(Stroke$hypertension)
Stroke$heart_disease <- as.factor(Stroke$heart_disease)

summary(Stroke)
stat.desc(Stroke, basic = FALSE, norm = TRUE)

hist(Stroke$age)

#applying glm
strokepredict <- glm(stroke ~ gender + age + hypertension + heart_disease + ever_married + work_type + Residence_type + avg_glucose_level + bmi + smoking_status, data = Stroke, family="binomial")
summary(strokepredict)

round (exp(coef(strokepredict)),3)
```

